{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block page_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
{% endblock %}

{% block content %}

<div class="admin-container">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <div>
            <h1>Admin Dashboard</h1>
            <p class="subtitle">Manage your contact messages and users</p>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon messages-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ contacts|length }}</div>
                <div class="stat-label">Contact Messages</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon users-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ users|length }}</div>
                <div class="stat-label">Registered Users</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon admin-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ users|selectattr('role', 'equalto', 'admin')|list|length }}</div>
                <div class="stat-label">Admin Users</div>
            </div>
        </div>
    </div>

    <!-- Contact Messages Section -->
    <div class="section-card contact-messages-section">
        <div class="section-header">
            <h2>Contact Messages</h2>
            <span class="badge">{{ contacts|length }} total</span>
        </div>

        <div class="table-wrapper">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Subject</th>
                        <th>Message</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% if contacts|length > 0 %}
                        {% for c in contacts %}
                        <tr>
                            <td><span class="id-badge">{{ c.id }}</span></td>
                            <td class="name-cell">{{ c.name }}</td>
                            <td class="email-cell">{{ c.email }}</td>
                            <td class="subject-cell">{{ c.subject }}</td>
                            <td class="message-cell" title="{{ c.message }}">{{ c.message }}</td>
                            <td class="actions-cell">
                                <a href="/edit/{{ c.id }}" class="btn-edit">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                    </svg>
                                    Edit
                                </a>
                                <a href="/delete/{{ c.id }}" 
                                   class="btn-delete"
                                   onclick="return confirm('Are you sure you want to delete this message?')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="3 6 5 6 21 6"></polyline>
                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    </svg>
                                    Delete
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="6" class="empty-state">
                                <div class="empty-icon">ðŸ“­</div>
                                <p>No contact messages yet</p>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Registered Users Section -->
    <div class="section-card users-section">
        <div class="section-header">
            <h2>Registered Users</h2>
            <span class="badge">{{ users|length }} total</span>
        </div>

        <div class="table-wrapper">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>Role</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% if users|length > 0 %}
                        {% for user in users %}
                        <tr>
                            <td><span class="id-badge">{{ user.id }}</span></td>
                            <td class="username-cell">
                                <div class="user-avatar">{{ user.username[0]|upper }}</div>
                                {{ user.username }}
                            </td>
                            <td>
                                {% if user.role == 'admin' %}
                                    <span class="role-badge admin-badge">Admin</span>
                                {% else %}
                                    <span class="role-badge user-badge">User</span>
                                {% endif %}
                            </td>
                            <td>
                                <span class="status-badge active">Active</span>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="4" class="empty-state">
                                <div class="empty-icon">ðŸ‘¥</div>
                                <p>No registered users yet</p>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

</div>

{% endblock %}